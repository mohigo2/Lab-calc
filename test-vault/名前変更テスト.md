# 名前変更機能テスト (改良版)

以下のコードブロックでタイトルを編集して、エディターAPIでソースが更新されるかテストしてください。

**重要**: テスト前に Developer Console (F12) を開いてログを確認してください。

## バッファー計算

```buffer
name: テ
totalVolume: 100
volumeUnit: mL
components:
  - name: Tris-HC
    stockConc: 1
    stockUnit: M
    finalConc: 50
    finalUnit: mM
```

## ストック溶液計算

```stock
name: テスト
reagentName: NaCl
molecularWeight: 58.44
targetConcentration: 100
concentrationUnit: mM
volume: 10
volumeUnit: mL
```

## 希釈計算

```dilution
name: テスト希釈
stockConcentration: 1000
stockConcentrationUnit: mM
finalConcentration: 100
finalConcentrationUnit: mM
finalVolume: 100
volumeUnit: µL
```

## 段階希釈計算

```serial-dilution
name: テスト段階希釈
stockConcentration: 10
stockUnit: mM
cellVolume: 200
cellVolumeUnit: µL
additionVolume: 2
additionVolumeUnit: µL
dilutionVolume: 200
dilutionVolumeUnit: µL
targetConcentrations: [100, 10, 1, 0.1]
targetUnit: µM
targetInputMode: exponential
stepDisplayFormat: text
```

## テスト手順（エディターAPI版）

### 基本テスト
1. **F12でDeveloper Consoleを開く** - ログを確認できるようにする
2. 各計算ブロックのタイトル（名前）をクリックして編集モードに入る
3. 新しい名前を入力（例: "修正されたタイトル2024"）
4. **Enterキー**またはフォーカスを外してから**Console を確認**
5. 以下のログが表示されることを確認：
   - "Starting block source update..."
   - "Section info: {lineStart: X, lineEnd: Y, ...}"
   - "Generated new YAML: ..."
   - "Block source updated successfully via editor API"

### 詳細テスト
6. **ソースビューに切り替えて**、変更が反映されているか確認
7. **プレビューに戻って**名前が保持されているか確認
8. **ページを再読み込み**して変更が保持されるか確認

### 期待される動作：
- ✅ UIで変更した名前がリアルタイムでソースコードに反映される
- ✅ エディターAPIを使用して安全にファイルを更新する
- ✅ ページ再読み込み後も変更が保持される
- ✅ 複数ブロックで同時編集しても正しく動作する

### トラブルシューティング用ログ：
コンソールで以下のエラーメッセージが表示された場合：
- "No active markdown editor found" → 編集モードになっているか確認
- "Current file does not match context path" → 正しいファイルを編集しているか確認
- "Could not get section information" → ブロックの位置情報取得エラー
- "Update already in progress" → 更新の重複実行を防止（正常動作）